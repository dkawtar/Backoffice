<?phpnamespace BackBundle\Service;/** * Description of AD * * @author Yann */class LdapService{    protected $host = "10.0.0.100";    protected $port;    protected $version;    protected $ldapSSL;    protected $ldapTLS;    protected $ldapConnect;    public function __construct($host, $port = 389, $version = 3, $ldapSSL = false, $ldapTLS = false)    {        $this->ldapTree = $host;        $this->port = $port;        $this->version = $version;        $this->ldapSSL = $ldapSSL;        $this->ldapTLS = $ldapTLS;        if (true === $this->ldapSSL) {            $this->ldapConnect = @ldap_connect("ldaps://" . $this->host, $this->port); //or die("Could not connect to LDAP server.");        } else {            $this->ldapConnect = @ldap_connect("ldap://" . $this->host, $this->port);// or die("Could not connect to LDAP server.");        }        @ldap_set_option($this->ldapConnect, LDAP_OPT_PROTOCOL_VERSION, $this->version);        @ldap_set_option($this->ldapConnect, LDAP_OPT_REFERRALS, 0);    }    /**     * @return bool|resource     */    public function getLdapConnect()    {        if (!$this->ldapConnect) {            if (true === $this->ldapSSL) {                $this->ldapConnect = @ldap_connect("ldaps://" . $this->host, $this->port); //or die("Could not connect to LDAP server.");            } else {                $this->ldapConnect = @ldap_connect("ldap://" . $this->host, $this->port);// or die("Could not connect to LDAP server.");            }            @ldap_set_option($this->ldapConnect, LDAP_OPT_PROTOCOL_VERSION, $this->version);            @ldap_set_option($this->ldapConnect, LDAP_OPT_REFERRALS, 0);        }        return $this->ldapConnect;    }    /**     * @param $ldapUser     * @param $password     * @return bool     */    function isAuthorized($ldapUser, $password)    {        $result = false;        if ($this->ldapConnect) {            $result = @ldap_bind($this->ldapConnect, $ldapUser, $password);        }        return $result;    }}